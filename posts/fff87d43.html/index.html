<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Linux实用运维脚本 | TYsec</title><meta name="author" content="TYsec"><meta name="copyright" content="TYsec"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="常用命令1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253#查看僵尸进程ps -al | gawk &amp;#x27;&amp;#123;print $2,$4&amp;#125;&amp;#x27; | grep Z# 匹配电子邮件的地址cat index.html | egrep">
<meta property="og:type" content="article">
<meta property="og:title" content="Linux实用运维脚本">
<meta property="og:url" content="http://example.com/posts/fff87d43.html/index.html">
<meta property="og:site_name" content="TYsec">
<meta property="og:description" content="常用命令1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253#查看僵尸进程ps -al | gawk &amp;#x27;&amp;#123;print $2,$4&amp;#125;&amp;#x27; | grep Z# 匹配电子邮件的地址cat index.html | egrep">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s2.loli.net/2023/01/15/5KLlANftgSvFBz2.jpg">
<meta property="article:published_time" content="2023-02-07T06:53:29.000Z">
<meta property="article:modified_time" content="2023-02-07T06:55:05.804Z">
<meta property="article:author" content="TYsec">
<meta property="article:tag" content="Linux运维">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.loli.net/2023/01/15/5KLlANftgSvFBz2.jpg"><link rel="shortcut icon" href="https://q1.qlogo.cn/g?b=qq&nk=2142516016&s=640"><link rel="canonical" href="http://example.com/posts/fff87d43.html/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":1,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: TYsec","link":"链接: ","source":"来源: TYsec","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Linux实用运维脚本',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-02-07 14:55:05'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.2"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>const preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',()=> { preloader.endLoading() })

if (false) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://q1.qlogo.cn/g?b=qq&amp;nk=2142516016&amp;s=640" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">11</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">8</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">11</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://s2.loli.net/2023/01/15/5KLlANftgSvFBz2.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">TYsec</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Linux实用运维脚本</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-02-07T06:53:29.000Z" title="发表于 2023-02-07 14:53:29">2023-02-07</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-02-07T06:55:05.804Z" title="更新于 2023-02-07 14:55:05">2023-02-07</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AE%9E%E7%94%A8%E8%84%9A%E6%9C%AC/">实用脚本</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">7.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>33分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Linux实用运维脚本"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h3 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a><strong>常用命令</strong></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看僵尸进程</span></span><br><span class="line">ps -al | gawk &#x27;&#123;print $2,$4&#125;&#x27; | grep Z</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">匹配电子邮件的地址</span></span><br><span class="line">cat index.html | egrep -o &quot;[A-Za-z0-9._]+@[A-Za-z0-9.]+\.[a-zA-Z]&#123;2,4&#125;&quot; &gt; ans.txt</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">匹配http URL</span></span><br><span class="line">cat index.html | egrep -o &quot;http://[A-Za-z0-9.]+\.[a-zA-Z]&#123;2,3&#125;&quot; &gt; ans.txt </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">纯文本形式下载网页</span></span><br><span class="line">lynx -dump www.baidu.com &gt; plain.txt</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">只打印HTTP头部信息，无须远程下载文件</span></span><br><span class="line">curl --head www.baidu.com</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">使用POST提交数据</span></span><br><span class="line">curl -d &quot;param2=nickwolfe¶m2=12345&quot; http://www.linuxidc.com/login.cgi</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">显示分组途经的网关</span></span><br><span class="line">traceroute www.baidu.com</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">列出系统中的开放端口以及运行在端口上的服务</span></span><br><span class="line">lsof -i </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">nc命令建立socket连接</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">设置监听　nc -l 5555</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">连接到套接字 nc 192.0.0.1 5555</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">快速文件传输</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">接收端　nc -l 5555 &gt; destination_filename</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">发送端　nc 192.0.0.1 5555 &lt; source_filename</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">找出指定目录最大的n个文件</span></span><br><span class="line">du -ak target_dir | sort -nrk 1 | head -n 4</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">du</span>中a为递归,k为kb；<span class="built_in">sort</span>中n为数字,r为降序,k指定列</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">向终端中的所有登陆用户发送广播信息</span></span><br><span class="line">cat message.txt | wall</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">创建新的screen窗口</span></span><br><span class="line">screen</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">打印所有的.txt和.pdf文件</span></span><br><span class="line">find . \( -name &quot;*.txt&quot; -o -name &quot;*.pdf&quot; \) -print</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">-<span class="built_in">exec</span> <span class="built_in">command</span> &#123;&#125; \;是连用的，所有符合的都会放置在&#123;&#125;中，去执行<span class="built_in">command</span></span> </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">将文件分割成多个大小为10kb的文件</span></span><br><span class="line">split -b 10k data.file</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">打印两个文件的交集</span></span><br><span class="line">comm A.txt B.txt -3 | sed &#x27;s/^\t//&#x27;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">sed移除空白行</span></span><br><span class="line">sed &#x27;/^$/d&#x27; file</span><br></pre></td></tr></table></figure>





<h3 id="mysql备份"><a href="#mysql备份" class="headerlink" title="mysql备份"></a><strong>mysql备份</strong></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">set -e</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">USER=&quot;backup&quot;</span><br><span class="line">PASSWORD=&quot;backup&quot;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">数据库数据目录 <span class="comment">#</span></span></span><br><span class="line">DATA_DIR=&quot;/data/mysql&quot;</span><br><span class="line">BIN_INDEX=$DATA_DIR&quot;/mysql-bin.index&quot;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">备份目录 <span class="comment">#</span></span></span><br><span class="line">BACKUP_DIR=&quot;/data/backup/mysql&quot;</span><br><span class="line">BACKUP_LOG=&quot;/var/log/mysql/backup.log&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">DATE=`date +&quot;%Y%m%d&quot;`</span><br><span class="line">TIME=`date +&quot;%Y%m%d%H&quot;`</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">LOG_TIME=`date +&quot;%Y-%m-%d %H:%M:%S&quot;`</span><br><span class="line">DELETE_BINLOG_TIME=&quot;7 day&quot;</span><br><span class="line">INCREMENT_INTERVAL=&quot;3 hour&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">note() &#123;</span><br><span class="line">    printf &quot;[$LOG_TIME] note: $*\n&quot; &gt;&gt; $BACKUP_LOG;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">warning() &#123;</span><br><span class="line">    printf &quot;[$LOG_TIME] warning: $*\n&quot; &gt;&gt; $BACKUP_LOG;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">error() &#123;</span><br><span class="line">    printf &quot;[$LOG_TIME] error: $*\n&quot; &gt;&gt; $BACKUP_LOG;</span><br><span class="line">    exit 1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">full_backup() &#123;</span><br><span class="line">    local dbs=`ls -l $DATA_DIR | grep &quot;^d&quot; | awk -F &quot; &quot; &#x27;&#123;print $9&#125;&#x27;`</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    for db in $dbs</span><br><span class="line">    do</span><br><span class="line">        local backup_dir=$BACKUP_DIR&quot;/full/&quot;$db</span><br><span class="line">        local filename=$db&quot;.&quot;$DATE</span><br><span class="line">        local backup_file=$backup_dir&quot;/&quot;$filename&quot;.sql&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        if [ ! -d $backup_dir ]</span><br><span class="line">        then</span><br><span class="line">            mkdir -p $backup_dir || &#123; error &quot;创建数据库 $db 全量备份目录 $backup_dir 失败&quot;; continue; &#125;</span><br><span class="line">            note &quot;数据库 $db 全量备份目录 $backup_dir  不存在，创建完成&quot;;</span><br><span class="line">        fi</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        note &quot;full backup $db start ...&quot;</span><br><span class="line">        mysqldump --user=$&#123;USER&#125; --password=$&#123;PASSWORD&#125; --flush-logs --skip-lock-tables --quick $db &gt; $backup_file || &#123; warning &quot;数据库 $db 备份失败&quot;; continue; &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        cd $backup_dir</span><br><span class="line">        tar -cPzf $filename&quot;.tar.gz&quot; $filename&quot;.sql&quot;</span><br><span class="line">        rm -f $backup_file</span><br><span class="line">        chown -fR mysql:mysql $backup_dir</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        note &quot;数据库 $db 备份成功&quot;;</span><br><span class="line">        note &quot;full backup $db end.&quot;</span><br><span class="line">    done</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">increment_backup() &#123;</span><br><span class="line">    local StartTime=`date &quot;-d $INCREMENT_INTERVAL ago&quot; +&quot;%Y-%m-%d %H:%M:%S&quot;`</span><br><span class="line">    local DELETE_BINLOG_END_TIME=`date &quot;-d $DELETE_BINLOG_TIME ago&quot; +&quot;%Y-%m-%d %H:%M:%S&quot;`</span><br><span class="line">    local dbs=`ls -l $DATA_DIR | grep &quot;^d&quot; | awk -F &quot; &quot; &#x27;&#123;print $9&#125;&#x27;`</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    mysql -u$USER -p$PASSWORD -e &quot;purge master logs before &#x27;$DELETE_BINLOG_END_TIME&#x27;&quot; &amp;&amp; note &quot;delete $DELETE_BINLOG_TIME days before log&quot;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    filename=`cat $BIN_INDEX | awk -F &quot;/&quot; &#x27;&#123;print $2&#125;&#x27;`</span><br><span class="line">    for i in $filename</span><br><span class="line">    do</span><br><span class="line">        for db in $dbs</span><br><span class="line">        do</span><br><span class="line">            local backup_dir=$BACKUP_DIR&quot;/increment/&quot;$db</span><br><span class="line">            local filename=$db&quot;.&quot;$TIME</span><br><span class="line">            local backup_file=$backup_dir&quot;/&quot;$filename&quot;.sql&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            if [ ! -d $backup_dir ]</span><br><span class="line">            then</span><br><span class="line">                mkdir -p $backup_dir || &#123; error &quot;创建数据库 $db 增量备份目录 $backup_dir 失败&quot;; continue; &#125;</span><br><span class="line">                note &quot;数据库 $db 增量备份目录 $backup_dir  不存在，创建完成&quot;;</span><br><span class="line">            fi</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            note &quot;increment backup $db form time $StartTime start ...&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            mysqlbinlog -d $db --start-datetime=&quot;$StartTime&quot; $DATA_DIR/$i &gt;&gt; $backup_file || &#123; warning &quot;数据库 $db 备份失败&quot;; continue; &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            note &quot;increment backup $db end.&quot;</span><br><span class="line">        done</span><br><span class="line">    done</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    for db in $dbs</span><br><span class="line">    do</span><br><span class="line">        local backup_dir=$BACKUP_DIR&quot;/increment/&quot;$db</span><br><span class="line">        local filename=$db&quot;.&quot;$TIME</span><br><span class="line">        local backup_file=$backup_dir&quot;/&quot;$filename&quot;.sql&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        cd $backup_dir</span><br><span class="line">        tar -cPzf $filename&quot;.tar.gz&quot; $filename&quot;.sql&quot;</span><br><span class="line">        rm -f $backup_file</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        note &quot;数据库 $db 备份成功&quot;;</span><br><span class="line">    done</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">case &quot;$1&quot; in</span><br><span class="line">    full)</span><br><span class="line">        full_backup</span><br><span class="line">    ;;</span><br><span class="line">    increment)</span><br><span class="line">        increment_backup</span><br><span class="line">    ;;</span><br><span class="line">    *)</span><br><span class="line">        exit 2</span><br><span class="line">    ;;</span><br><span class="line">esac</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">exit 1</span><br></pre></td></tr></table></figure>

<h3 id="目录备份"><a href="#目录备份" class="headerlink" title="目录备份"></a><strong>目录备份</strong></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment">#</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">时间</span></span><br><span class="line">DATE=$(date &#x27;+%Y-%m-%d_%H_%M_%S&#x27;)</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">备份目录</span> </span><br><span class="line">BACKUPDIR=&quot;/home/backups&quot;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">需要备份的目录</span></span><br><span class="line">SORFILE=/opt</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">目标文件名</span></span><br><span class="line">DESFILE=/home/backups/$SORFILE.$(date &#x27;+%Y-%m-%d_%H_%M_%S&#x27;).zip</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[ ! -d $BACKUPDIR ] &amp;&amp; mkdir -p $BACKUPDIR</span><br><span class="line">cd $BACKUPDIR</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">echo &quot;start backup $SORFILE ...&quot;</span><br><span class="line">sleep 3</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$DESFILE</span>&quot;</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">tar cvf <span class="variable">$DESFILE</span> <span class="variable">$SORFILE</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">gzip -f .zip <span class="variable">$DESFILE</span></span></span><br><span class="line">zip -r $DESFILE $SORFILE &amp;&gt;/dev/null</span><br><span class="line">if [ &quot;$?&quot; == &quot;0&quot; ]</span><br><span class="line">then</span><br><span class="line">   echo $(date +%Y-%m-%d)&quot; zip sucess&quot;&gt;&gt;backup.log</span><br><span class="line">else</span><br><span class="line">   echo $(date +%Y-%m-%d)&quot; zip failed&quot;&gt;&gt;backup.log</span><br><span class="line">   exit 0</span><br><span class="line">fi</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">删除3天前的备份</span></span><br><span class="line">find $BACKUPDIR -type f -ctime +3 | xargs rm -rf</span><br></pre></td></tr></table></figure>

<h3 id="PING查询"><a href="#PING查询" class="headerlink" title="PING查询"></a><strong>PING查询</strong></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">用途：根据网络配置对网络地址192.168.0进行修改，检查是否是活动状态</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">&#123;start..end&#125;shell扩展生成一组地址</span></span><br><span class="line">for ip in 192.168.0.&#123;1..255&#125;</span><br><span class="line">do </span><br><span class="line">    (</span><br><span class="line">    ping $ip -c 2 &amp;&gt; /dev/null </span><br><span class="line">    # &gt; 标准输出重定向，和1&gt;一致</span><br><span class="line">    # 2&gt;&amp;1 将标准错误输出　重定向　到标准输出</span><br><span class="line">    # &amp;&gt;file 将标准输出和标准错误输出都重定向到文件filename中</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    if [ $? -eq 0 ];then</span><br><span class="line">        echo $ip is alive</span><br><span class="line">    fi</span><br><span class="line">    )&amp;</span><br><span class="line">done</span><br><span class="line">wait</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">并行ping,加速</span></span><br></pre></td></tr></table></figure>

<h3 id="磁盘IO检查"><a href="#磁盘IO检查" class="headerlink" title="磁盘IO检查"></a><strong>磁盘IO检查</strong></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#iostat是查看磁盘活动统计情况</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#显示所有设备负载情况 r/s:  每秒完成的读 I/O 设备次数。即 rio/s；w/s:  每秒完成的写 I/O 设备次数。即 wio/s等</span></span></span><br><span class="line">iostat </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#每隔2秒刷新磁盘IO信息，并且每次显示3次</span></span></span><br><span class="line">iostat 2 3</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">显示某个磁盘的IO信息</span></span><br><span class="line">iostat -d sda1</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#显示tty和cpu信息</span></span></span><br><span class="line">iostat -t</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#以M为单位显示磁盘IO信息</span></span></span><br><span class="line">iostat -m</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#查看TPS和吞吐量信息  kB_read/s：每秒从设备（drive expressed）读取的数据量；kB_wrtn/s：每秒向设备（drive expressed）写入的数据量；kB_read：读取的总数据量；kB_wrtn：写入的总数量数据量；</span></span></span><br><span class="line">iostat -d -k 1 1</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看设备使用率（%util）、响应时间（await）</span></span><br><span class="line">iostat -d -x -k 1 1</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看CPU状态</span></span><br><span class="line">iostat -c 1 3</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">统计进程(pid)的<span class="built_in">stat</span>,进程的<span class="built_in">stat</span>自然包括进程的IO状况</span></span><br><span class="line">pidstat</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">只显示IO</span></span><br><span class="line">pidstat -d  1 </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">-d IO 信息,-r 缺页及内存信息-u CPU使用率-t 以线程为统计单位1  1秒统计一次</span></span><br><span class="line">pidstat -u -r -d -t 1</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">文件级IO分析,查看当前文件由哪些进程打开</span></span><br><span class="line">lsof   </span><br><span class="line">ls /proc/pid/fd</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">利用 sar 报告磁盘 I/O 信息DEV 正在监视的块设备 tps 每秒钟物理设备的 I/O 传输总量 rd_sec/s 每秒从设备读取的扇区数量 wr_sec/s 每秒向设备写入的扇区数量 avgrq-sz I/O 请求的平均扇区数</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">avgqu-sz I/O 请求的平均队列长度 await I/O 请求的平均等待时间，单位为毫秒 svctm I/O 请求的平均服务时间，单位为毫秒 %util I/O 请求所占用的时间的百分比，即设备利用率</span></span><br><span class="line">sar -pd 10 3 </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">iotop  top的io版</span></span><br><span class="line">iotop</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看页面缓存信息 其中的Cached 指用于pagecache的内存大小（diskcache-SwapCache）。随着写入缓存页，Dirty 的值会增加 一旦开始把缓存页写入硬盘,Writeback的值会增加直到写入结束。</span></span><br><span class="line">cat /proc/meminfo </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看有多少个pdflush进程 Linux 用pdflush进程把数据从缓存页写入硬盘</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">pdflush的行为受/proc/sys/vm中的参数的控制/proc/sys/vm/dirty_writeback_centisecs (default 500): 1/100秒, 多长时间唤醒pdflush将缓存页数据写入硬盘。默认5秒唤醒2个（更多个）线程。如果wrteback的时间长于dirty_writeback_centisecs的时间，可能会出问题</span></span><br><span class="line">cat /proc/sys/vm/nr_pdflush_threads</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看I/O 调度器</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">调度算法</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">noop anticipatory deadline [cfq]</span> </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">deadline :    deadline 算法保证对既定的IO请求以最小的延迟时间。</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">anticipatory：有个IO发生后，如果又有进程请求IO，则产生一个默认6ms猜测时间，猜测下一个进程请求IO是干什么。这对于随机读取会造成较大的延时。对数据库应用很糟糕，而对于Web Server等则会表现不错。</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">cfq:        对每个进程维护一个IO队列，各个进程发来的IO请求会被cfq以轮循方式处理，对每一个IO请求都是公平。适合离散读的应用。</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">noop:        对所有IO请求都用FIFO队列形式处理。默认IO不会存在性能问题。</span></span><br><span class="line">cat /sys/block/[disk]/queue/scheduler</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">改变IO调度器</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> deadline &gt; /sys/block/sdX/queue/scheduler</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">提高调度器请求队列的</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> 4096 &gt; /sys/block/sdX/queue/nr_requests</span></span><br></pre></td></tr></table></figure>

<h3 id="性能相关"><a href="#性能相关" class="headerlink" title="性能相关"></a><strong>性能相关</strong></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看当前系统load</span></span><br><span class="line">uptime</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看系统状态和每个进程的系统资源使用状况</span></span><br><span class="line">top</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">可视化显示CPU的使用状况</span></span><br><span class="line">htop</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看每个CPU的负载信息</span></span><br><span class="line">mpstat -P ALL 1</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">每隔1秒查看磁盘IO的统计信息</span></span><br><span class="line">iostat -xkdz 1</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">每隔一秒查看虚拟内存的使用信息</span></span><br><span class="line">vmstat 1</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看内存使用统计信息</span></span><br><span class="line">free</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看网络使用信息</span></span><br><span class="line">nicstat -z 1</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">类似vmstat的显示优化的工具</span></span><br><span class="line">dstat 1</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看系统活动状态，比如系统分页统计，块设备IO统计等</span></span><br><span class="line">sar</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">网络连接状态查看</span></span><br><span class="line">netstat -s</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">进程资源使用信息查看</span></span><br><span class="line">pidstat 1</span><br><span class="line">pidstat -d 1</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看某个进程的系统调用信息 -p后面是进程<span class="built_in">id</span>，-tttT 进程系统后的系统调用时间</span></span><br><span class="line">strace -tttT -p 12670</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">统计IO设备输入输出的系统调用信息</span></span><br><span class="line">strace -c dd if=/dev/zero of=/dev/null bs=512 count=1024k</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">tcpdump 查看网络数据包</span></span><br><span class="line">tcpdump -nr /tmp/out.tcpdump</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">块设备的读写事件信息统计</span></span><br><span class="line">btrace /dev/sdb </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">iotop查看某个进程的IO操作统计信息</span></span><br><span class="line">iotop -bod5</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">slabtop 查看内核 slab内存分配器的使用信息</span></span><br><span class="line">slabtop -sc</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">系统参数设置</span></span><br><span class="line">sysctl -a</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">系统性能指标统计信息</span></span><br><span class="line">perf stat gzip file1</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">系统cpu活动状态查看</span></span><br><span class="line">perf record -a -g -F 997 sleep 10</span><br></pre></td></tr></table></figure>

<h3 id="进程相关"><a href="#进程相关" class="headerlink" title="进程相关"></a><strong>进程相关</strong></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># processes  进程管理</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#ps查看当前系统执行的线程列表，进行瞬间状态，不是连续状态，连续状态需要使用top名称查看  更多常用参数请使用 man ps查看</span></span></span><br><span class="line">ps</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#显示所有进程详细信息</span></span></span><br><span class="line">ps aux</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#-u 显示某个用户的进程列表</span></span></span><br><span class="line">ps -f -u www-data </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># -C 通过名字或者命令搜索进程</span></span></span><br><span class="line">ps -C apache2</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># --sort  根据进程cpu使用率降序排列，查看前5个进程  -pcpu表示降序  pcpu升序</span></span></span><br><span class="line">ps aux --sort=-pcpu | head -5 </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#-f 用树结构显示进程的层次关系，父子进程情况下</span></span></span><br><span class="line">ps -f --forest -C apache2 </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#显示一个父进程的所有子进程</span></span></span><br><span class="line">ps -o pid,uname,comm -C apache2</span><br><span class="line">ps --ppid 2359 </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#显示一个进程的所有线程  -L 参数</span></span></span><br><span class="line">ps -p 3150 -L </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#显示进程的执行时间 -o参数</span></span></span><br><span class="line">ps -e -o pid,comm,etime </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#watch命令可以用来实时捕捉ps显示进程</span></span></span><br><span class="line">watch -n 1 &#x27;ps -e -o pid,uname,cmd,pmem,pcpu --sort=-pmem,-pcpu | head -15&#x27; </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#jobs 查看后台运行的进程  jobs命令执行的结果，＋表示是一个当前的作业，减号表是是一个当前作业之后的一个作业，jobs -l选项可显示所有任务的PID,jobs的状态可以是running, stopped, Terminated,但是如果任务被终止了（kill），shell 从当前的shell环境已知的列表中删除任务的进程标识；也就是说，jobs命令显示的是当前shell环境中所起的后台正在运行或者被挂起的任务信息</span></span></span><br><span class="line">jobs</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#查看后台运营的进程号</span></span></span><br><span class="line">jobs -p</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#查看现在被终止或者退出的进程号</span></span></span><br><span class="line">jobs -n</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#kill命令 终止一个前台进程可以使用Ctrl+C键   kill  通过top或者ps获取进程id号  kill [-s 信号 | -p ] [ -a ] 进程号 ...</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#发送指定的信号到相应进程。不指定型号将发送SIGTERM（15）终止指定进程。关闭进程号12的进程</span></span></span><br><span class="line">kill 12</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#等同于在前台运行PID为123的进程时按下Ctrl+C键</span></span></span><br><span class="line">kill -2 123</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#如果任无法终止该程序可用“-KILL” 参数，其发送的信号为SIGKILL(9) ，将强制结束进程</span></span>  </span><br><span class="line">kill -9 123</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#列出所有信号名称</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#HUP    1    终端断线</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#INT     2    中断（同 Ctrl + C）</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#QUIT    3    退出（同 Ctrl + \）</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#TERM   15    终止</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#KILL    9    强制终止</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#CONT   18    继续（与STOP相反， fg/bg命令）</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#STOP    19    暂停（同 Ctrl + Z）</span></span></span><br><span class="line">kill -l</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#得到指定信号的数值</span></span></span><br><span class="line">kill -l KILL</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#杀死指定用户所有进程</span></span></span><br><span class="line">kill -u peidalinux</span><br><span class="line">kill -9 $(ps -ef | grep peidalinux) </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#将后台中的命令调至前台继续运行  将进程123调至前台执行</span></span></span><br><span class="line">fg 123</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#将一个在后台暂停的命令，变成继续执行</span></span></span><br><span class="line">bg  123</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#该命令可以在你退出帐户/关闭终端之后继续运行相应的进程。nohup就是不挂起的意思  下面输出被重定向到myout.file文件中</span></span></span><br><span class="line">nohup command &gt; myout.file 2&gt;&amp;1 &amp;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#at：计划任务，在特定的时间执行某项工作，在特定的时间执行一次。</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># 格式：at HH:MM YYYY-MM-DD //HH（小时）:MM（分钟） YYYY（年）-MM（月份）-DD（日）</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#HH[am pm]+D(天) days //HH（小时）[am（上午）pm（下午）]+days（天）</span></span></span><br><span class="line">at 12:00（时间） //at命令设定12:00执行一项操作</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">at&gt;useradd aaa //在at命令里设定添加用户aaa</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">ctrl+d //退出at命令</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="built_in">tail</span> -f /etc/passwd //查看/etc/passwd文件后十行是否增加了一个用户aaa</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#计划任务设定后，在没有执行之前我们可以用atq命令来查看系统没有执行工作任务。</span></span></span><br><span class="line">atq</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#启动计划任务后，如果不想启动设定好的计划任务可以使用atrm命令删除。</span></span></span><br><span class="line">atrm 1 //删除计划任务1</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#pstree命令：列出当前的进程，以及它们的树状结构  格式：pstree [选项] [pid|user]</span></span></span><br><span class="line">pstree</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#nice命令：改变程序执行的优先权等级 应用程序优先权值的范围从-20～19，数字越小，优先权就越高。一般情况下，普通应用程序的优先权值（CPU使用权值）都是0，如果让常用程序拥有较高的优先权等级，自然启动和运行速度都会快些。需要注意的是普通用户只能在0～19之间调整应用程序的优先权值，只有超级用户有权调整更高的优先权值（从-20～19）。</span></span></span><br><span class="line">nice [-n &lt;优先等级&gt;][--help][--version][命令]</span><br><span class="line">nice -n 5 ls</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#sleep命令：使进程暂停执行一段时间</span></span></span><br><span class="line">date;sleep 1m;date</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#renice命令 renice命令允许用户修改一个正在运行进程的优先权。利用renice命令可以在命令执行时调整其优先权。</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#其中，参数number与nice命令的number意义相同。（1） 用户只能对自己所有的进程使用renice命令。（2） root用户可以在任何进程上使用renice命令。（3） 只有root用户才能提高进程的优先权</span></span></span><br><span class="line">renice -5 -p 5200  #PID为5200的进程nice设为-5 </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#pmap命令用于显示一个或多个进程的内存状态。其报告进程的地址空间和内存状态信息 #pmap PID</span></span> </span><br><span class="line">pmap 20367</span><br></pre></td></tr></table></figure>

<h3 id="javadump-sh"><a href="#javadump-sh" class="headerlink" title="javadump.sh"></a><strong>javadump.sh</strong></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/sh</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">DUMP_PIDS=`ps  --no-heading -C java -f --width 1000 |awk &#x27;&#123;print $2&#125;&#x27;`</span><br><span class="line">if [ -z &quot;$DUMP_PIDS&quot; ]; then</span><br><span class="line">    echo &quot;The server $HOST_NAME is not started!&quot;</span><br><span class="line">    exit 1;</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">DUMP_ROOT=~/dump</span><br><span class="line">if [ ! -d $DUMP_ROOT ]; then</span><br><span class="line">  mkdir $DUMP_ROOT</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">DUMP_DATE=`date +%Y%m%d%H%M%S`</span><br><span class="line">DUMP_DIR=$DUMP_ROOT/dump-$DUMP_DATE</span><br><span class="line">if [ ! -d $DUMP_DIR ]; then</span><br><span class="line">  mkdir $DUMP_DIR</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">for PID in $DUMP_PIDS ; do</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">Full thread dump 用来查线程占用，死锁等问题</span></span><br><span class="line"><span class="meta prompt_">  $</span><span class="language-bash">JAVA_HOME/bin/jstack <span class="variable">$PID</span> &gt; <span class="variable">$DUMP_DIR</span>/jstack-<span class="variable">$PID</span>.dump 2&gt;&amp;1</span></span><br><span class="line">  echo -e &quot;.\c&quot;</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">打印出一个给定的Java进程、Java core文件或远程Debug服务器的Java配置信息，具体包括Java系统属性和JVM命令行参数。</span></span><br><span class="line"><span class="meta prompt_">  $</span><span class="language-bash">JAVA_HOME/bin/jinfo <span class="variable">$PID</span> &gt; <span class="variable">$DUMP_DIR</span>/jinfo-<span class="variable">$PID</span>.dump 2&gt;&amp;1</span></span><br><span class="line">  echo -e &quot;.\c&quot;</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">jstat能够动态打印jvm(Java Virtual Machine Statistics Monitoring Tool)的相关统计信息。如young gc执行的次数、full gc执行的次数，各个内存分区的空间大小和可使用量等信息。</span></span><br><span class="line"><span class="meta prompt_">  $</span><span class="language-bash">JAVA_HOME/bin/jstat -gcutil <span class="variable">$PID</span> &gt; <span class="variable">$DUMP_DIR</span>/jstat-gcutil-<span class="variable">$PID</span>.dump 2&gt;&amp;1</span></span><br><span class="line">  echo -e &quot;.\c&quot;</span><br><span class="line"><span class="meta prompt_">  $</span><span class="language-bash">JAVA_HOME/bin/jstat -gccapacity <span class="variable">$PID</span> &gt; <span class="variable">$DUMP_DIR</span>/jstat-gccapacity-<span class="variable">$PID</span>.dump 2&gt;&amp;1</span></span><br><span class="line">  echo -e &quot;.\c&quot;</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">未指定选项时，jmap打印共享对象的映射。对每个目标VM加载的共享对象，其起始地址、映射大小及共享对象文件的完整路径将被打印出来，</span>  </span><br><span class="line"><span class="meta prompt_">  $</span><span class="language-bash">JAVA_HOME/bin/jmap <span class="variable">$PID</span> &gt; <span class="variable">$DUMP_DIR</span>/jmap-<span class="variable">$PID</span>.dump 2&gt;&amp;1</span></span><br><span class="line">  echo -e &quot;.\c&quot;</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">-heap打印堆情况的概要信息，包括堆配置，各堆空间的容量、已使用和空闲情况</span>  </span><br><span class="line"><span class="meta prompt_">  $</span><span class="language-bash">JAVA_HOME/bin/jmap -heap <span class="variable">$PID</span> &gt; <span class="variable">$DUMP_DIR</span>/jmap-heap-<span class="variable">$PID</span>.dump 2&gt;&amp;1</span></span><br><span class="line">  echo -e &quot;.\c&quot;</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">-dump将jvm的堆中内存信息输出到一个文件中,然后可以通过eclipse memory analyzer进行分析</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">注意：这个jmap使用的时候jvm是处在假死状态的，只能在服务瘫痪的时候为了解决问题来使用，否则会造成服务中断。</span></span><br><span class="line"><span class="meta prompt_">  $</span><span class="language-bash">JAVA_HOME/bin/jmap -dump:format=b,file=<span class="variable">$DUMP_DIR</span>/jmap-dump-<span class="variable">$PID</span>.dump <span class="variable">$PID</span> 2&gt;&amp;1</span></span><br><span class="line">  echo -e &quot;.\c&quot;</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">显示被进程打开的文件信息</span></span><br><span class="line">if [ -r /usr/sbin/lsof ]; then</span><br><span class="line">  /usr/sbin/lsof -p $PID &gt; $DUMP_DIR/lsof-$PID.dump</span><br><span class="line">  echo -e &quot;.\c&quot;</span><br><span class="line">  fi</span><br><span class="line">done</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">主要负责收集、汇报与存储系统运行信息的。</span></span><br><span class="line">if [ -r /usr/bin/sar ]; then</span><br><span class="line">/usr/bin/sar &gt; $DUMP_DIR/sar.dump</span><br><span class="line">echo -e &quot;.\c&quot;</span><br><span class="line">fi</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">主要负责收集、汇报与存储系统运行信息的。</span></span><br><span class="line">if [ -r /usr/bin/uptime ]; then</span><br><span class="line">/usr/bin/uptime &gt; $DUMP_DIR/uptime.dump</span><br><span class="line">echo -e &quot;.\c&quot;</span><br><span class="line">fi</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">内存查看</span></span><br><span class="line">if [ -r /usr/bin/free ]; then</span><br><span class="line">/usr/bin/free -t &gt; $DUMP_DIR/free.dump</span><br><span class="line">echo -e &quot;.\c&quot;</span><br><span class="line">fi</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">可以得到关于进程、内存、内存分页、堵塞IO、traps及CPU活动的信息。</span></span><br><span class="line">if [ -r /usr/bin/vmstat ]; then</span><br><span class="line">/usr/bin/vmstat &gt; $DUMP_DIR/vmstat.dump</span><br><span class="line">echo -e &quot;.\c&quot;</span><br><span class="line">fi</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">报告与CPU相关的一些统计信息</span></span><br><span class="line">if [ -r /usr/bin/mpstat ]; then</span><br><span class="line">/usr/bin/mpstat &gt; $DUMP_DIR/mpstat.dump</span><br><span class="line">echo -e &quot;.\c&quot;</span><br><span class="line">fi</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">报告与IO相关的一些统计信息</span></span><br><span class="line">if [ -r /usr/bin/iostat ]; then</span><br><span class="line">/usr/bin/iostat &gt; $DUMP_DIR/iostat.dump</span><br><span class="line">echo -e &quot;.\c&quot;</span><br><span class="line">fi</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">报告与网络相关的一些统计信息</span></span><br><span class="line">if [ -r /bin/netstat ]; then</span><br><span class="line">/bin/netstat &gt; $DUMP_DIR/netstat.dump</span><br><span class="line">echo -e &quot;.\c&quot;</span><br><span class="line">fi</span><br><span class="line">echo &quot;OK!&quot;</span><br></pre></td></tr></table></figure>

<h3 id="常用工具安装"><a href="#常用工具安装" class="headerlink" title="常用工具安装"></a><strong>常用工具安装</strong></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/usr/bin/env bash</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">---------------------------------------------------------------------------------</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">控制台颜色</span></span><br><span class="line">BLACK=&quot;\033[1;30m&quot;</span><br><span class="line">RED=&quot;\033[1;31m&quot;</span><br><span class="line">GREEN=&quot;\033[1;32m&quot;</span><br><span class="line">YELLOW=&quot;\033[1;33m&quot;</span><br><span class="line">BLUE=&quot;\033[1;34m&quot;</span><br><span class="line">PURPLE=&quot;\033[1;35m&quot;</span><br><span class="line">CYAN=&quot;\033[1;36m&quot;</span><br><span class="line">RESET=&quot;$(tput sgr0)&quot;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">---------------------------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">printf &quot;$&#123;BLUE&#125;\n&quot;</span><br><span class="line">cat &lt;&lt; EOF</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">##################################################################################</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">安装常用命令工具</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">命令工具清单如下：</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">核心工具：<span class="built_in">df</span>、<span class="built_in">du</span>、chkconfig</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">网络工具：ifconfig、netstat、route、iptables</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">IP工具：ip、ss、ping、tracepath、traceroute</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">DNS工具：dig、host、nslookup、whois</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">端口工具：lsof、nc、telnet</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">下载工具：curl、wget</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">编辑工具：emacs、vim</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">流量工具：iftop、nethogs</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">抓包工具：tcpdump</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">压缩工具：unzip、zip</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">版本控制工具：git、subversion</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment">###################################################################################</span></span></span><br><span class="line">EOF</span><br><span class="line">printf &quot;$&#123;RESET&#125;\n&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">printf &quot;\n$&#123;GREEN&#125;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 安装常用命令工具开始$&#123;RESET&#125;\n&quot;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">核心工具</span></span><br><span class="line">printf &quot;\n$&#123;CYAN&#125;&gt;&gt;&gt;&gt; install coreutils(df、du)$&#123;RESET&#125;\n&quot;</span><br><span class="line">yum install -y coreutils</span><br><span class="line">printf &quot;\n$&#123;CYAN&#125;&gt;&gt;&gt;&gt; install chkconfig$&#123;RESET&#125;\n&quot;</span><br><span class="line">yum install -y chkconfig</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">网络工具</span></span><br><span class="line">printf &quot;\n$&#123;CYAN&#125;&gt;&gt;&gt;&gt; install net-tools(ifconfig、netstat、route)$&#123;RESET&#125;\n&quot;</span><br><span class="line">yum install -y net-tools</span><br><span class="line">printf &quot;\n$&#123;CYAN&#125;&gt;&gt;&gt;&gt; install iptables$&#123;RESET&#125;\n&quot;</span><br><span class="line">yum install -y iptables</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">IP工具</span></span><br><span class="line">printf &quot;\n$&#123;CYAN&#125;&gt;&gt;&gt;&gt; install iputils(ping、tracepath)$&#123;RESET&#125;\n&quot;</span><br><span class="line">yum install -y iputils</span><br><span class="line">printf &quot;\n$&#123;CYAN&#125;&gt;&gt;&gt;&gt; install traceroute$&#123;RESET&#125;\n&quot;</span><br><span class="line">yum install -y traceroute</span><br><span class="line">printf &quot;\n$&#123;CYAN&#125;&gt;&gt;&gt;&gt; install iproute(ip、ss)$&#123;RESET&#125;\n&quot;</span><br><span class="line">yum install -y iproute</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">端口工具</span></span><br><span class="line">printf &quot;\n$&#123;CYAN&#125;&gt;&gt;&gt;&gt; install lsof$&#123;RESET&#125;\n&quot;</span><br><span class="line">yum install -y lsof</span><br><span class="line">printf &quot;\n$&#123;CYAN&#125;&gt;&gt;&gt;&gt; install nc$&#123;RESET&#125;\n&quot;</span><br><span class="line">yum install -y nc</span><br><span class="line">printf &quot;\n$&#123;CYAN&#125;&gt;&gt;&gt;&gt; install netstat$&#123;RESET&#125;\n&quot;</span><br><span class="line">yum install -y netstat</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">DNS工具</span></span><br><span class="line">printf &quot;\n$&#123;CYAN&#125;&gt;&gt;&gt;&gt; install bind-utils(dig、host、nslookup)$&#123;RESET&#125;\n&quot;</span><br><span class="line">yum install -y bind-utils</span><br><span class="line">printf &quot;\n$&#123;CYAN&#125;&gt;&gt;&gt;&gt; install whois$&#123;RESET&#125;\n&quot;</span><br><span class="line">yum install -y whois</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">下载工具</span></span><br><span class="line">printf &quot;\n$&#123;CYAN&#125;&gt;&gt;&gt;&gt; install curl$&#123;RESET&#125;\n&quot;</span><br><span class="line">yum install -y curl</span><br><span class="line">printf &quot;\n$&#123;CYAN&#125;&gt;&gt;&gt;&gt; install wget$&#123;RESET&#125;\n&quot;</span><br><span class="line">yum install -y wget</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">编辑工具</span></span><br><span class="line">printf &quot;\n$&#123;CYAN&#125;&gt;&gt;&gt;&gt; install emacs$&#123;RESET&#125;\n&quot;</span><br><span class="line">yum install -y emacs</span><br><span class="line">printf &quot;\n$&#123;CYAN&#125;&gt;&gt;&gt;&gt; install vim$&#123;RESET&#125;\n&quot;</span><br><span class="line">yum install -y vim</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">流量工具</span></span><br><span class="line">printf &quot;\n$&#123;CYAN&#125;&gt;&gt;&gt;&gt; install iftop$&#123;RESET&#125;\n&quot;</span><br><span class="line">yum install -y iftop</span><br><span class="line">printf &quot;\n$&#123;CYAN&#125;&gt;&gt;&gt;&gt; install nethogs$&#123;RESET&#125;\n&quot;</span><br><span class="line">yum install -y nethogs</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">抓包工具</span></span><br><span class="line">printf &quot;\n$&#123;CYAN&#125;&gt;&gt;&gt;&gt; install tcpdump$&#123;RESET&#125;\n&quot;</span><br><span class="line">yum install -y tcpdump</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">压缩工具</span></span><br><span class="line">printf &quot;\n$&#123;CYAN&#125;&gt;&gt;&gt;&gt; install unzip$&#123;RESET&#125;\n&quot;</span><br><span class="line">yum install -y unzip</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">版本控制工具</span></span><br><span class="line">printf &quot;\n$&#123;CYAN&#125;&gt;&gt;&gt;&gt; install git$&#123;RESET&#125;\n&quot;</span><br><span class="line">yum install -y git</span><br><span class="line">printf &quot;\n$&#123;CYAN&#125;&gt;&gt;&gt;&gt; install subversion$&#123;RESET&#125;\n&quot;</span><br><span class="line">yum install -y subversion</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">printf &quot;\n$&#123;GREEN&#125;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; 安装常用命令工具结束$&#123;RESET&#125;\n&quot;</span><br></pre></td></tr></table></figure>

<h3 id="常用lib库安装"><a href="#常用lib库安装" class="headerlink" title="常用lib库安装"></a><strong>常用lib库安装</strong></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/usr/bin/env bash</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">---------------------------------------------------------------------------------</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">控制台颜色</span></span><br><span class="line">BLACK=&quot;\033[1;30m&quot;</span><br><span class="line">RED=&quot;\033[1;31m&quot;</span><br><span class="line">GREEN=&quot;\033[1;32m&quot;</span><br><span class="line">YELLOW=&quot;\033[1;33m&quot;</span><br><span class="line">BLUE=&quot;\033[1;34m&quot;</span><br><span class="line">PURPLE=&quot;\033[1;35m&quot;</span><br><span class="line">CYAN=&quot;\033[1;36m&quot;</span><br><span class="line">RESET=&quot;$(tput sgr0)&quot;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">---------------------------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">printf &quot;$&#123;BLUE&#125;\n&quot;</span><br><span class="line">cat &lt;&lt; EOF</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">##################################################################################</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">安装常见 lib</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">如果不知道命令在哪个 lib，可以使用 yum search xxx 来查找</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">lib 清单如下：</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">gcc gcc-c++ kernel-devel libtool</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">openssl openssl-devel</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">zlib zlib-devel</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">pcre</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">##################################################################################</span></span></span><br><span class="line">EOF</span><br><span class="line">printf &quot;$&#123;RESET&#125;\n&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">printf &quot;\n$&#123;GREEN&#125;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; 安装常见 lib 开始$&#123;RESET&#125;\n&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">printf &quot;\n$&#123;CYAN&#125;&gt;&gt;&gt;&gt; install gcc gcc-c++ kernel-devel libtool$&#123;RESET&#125;\n&quot;</span><br><span class="line">yum -y install make gcc gcc-c++ kernel-devel libtool</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">printf &quot;\n$&#123;CYAN&#125;&gt;&gt;&gt;&gt; install openssl openssl-devel$&#123;RESET&#125;\n&quot;</span><br><span class="line">yum -y install make openssl openssl-devel</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">printf &quot;\n$&#123;CYAN&#125;&gt;&gt;&gt;&gt; install zlib zlib-devel$&#123;RESET&#125;\n&quot;</span><br><span class="line">yum -y install make zlib zlib-devel</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">printf &quot;\n$&#123;CYAN&#125;&gt;&gt;&gt;&gt; install pcre$&#123;RESET&#125;\n&quot;</span><br><span class="line">yum -y install pcre</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">printf &quot;\n$&#123;GREEN&#125;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; 安装常见 lib 结束$&#123;RESET&#125;\n&quot;</span><br></pre></td></tr></table></figure>

<h3 id="系统检查脚本"><a href="#系统检查脚本" class="headerlink" title="系统检查脚本"></a><strong>系统检查脚本</strong></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/usr/bin/env bash</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#############################################################################</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">console color</span></span><br><span class="line">C_RESET=&quot;$(tput sgr0)&quot;</span><br><span class="line">C_BLACK=&quot;\033[1;30m&quot;</span><br><span class="line">C_RED=&quot;\033[1;31m&quot;</span><br><span class="line">C_GREEN=&quot;\033[1;32m&quot;</span><br><span class="line">C_YELLOW=&quot;\033[1;33m&quot;</span><br><span class="line">C_BLUE=&quot;\033[1;34m&quot;</span><br><span class="line">C_PURPLE=&quot;\033[1;35m&quot;</span><br><span class="line">C_CYAN=&quot;\033[1;36m&quot;</span><br><span class="line">C_WHITE=&quot;\033[1;37m&quot;</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#############################################################################</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">printf &quot;$&#123;C_PURPLE&#125;&quot;</span><br><span class="line">cat &lt;&lt; EOF</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">##################################################################################</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">系统信息检查脚本</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">##################################################################################</span></span></span><br><span class="line">EOF</span><br><span class="line">printf &quot;$&#123;C_RESET&#125;&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[[ $(id -u) -gt 0 ]] &amp;&amp; echo &quot;请用root用户执行此脚本！&quot; &amp;&amp; exit 1</span><br><span class="line">sysversion=$(rpm -q centos-release | cut -d- -f3)</span><br><span class="line">double_line=&quot;===============================================================&quot;</span><br><span class="line">line=&quot;----------------------------------------------&quot;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">打印头部信息</span></span><br><span class="line">printHeadInfo() &#123;</span><br><span class="line">  cat &lt;&lt; EOF</span><br><span class="line">+---------------------------------------------------------------------------------+</span><br><span class="line">|                           欢迎使用 【系统信息检查脚本】                          |</span><br><span class="line">+---------------------------------------------------------------------------------+</span><br><span class="line">EOF</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">打印尾部信息</span></span><br><span class="line">printFootInfo() &#123;</span><br><span class="line">  cat &lt;&lt; EOF</span><br><span class="line">+---------------------------------------------------------------------------------+</span><br><span class="line">|                            脚本执行结束，感谢使用！|</span><br><span class="line">+---------------------------------------------------------------------------------+</span><br><span class="line">EOF</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">options=( &quot;获取系统信息&quot; &quot;获取服务信息&quot; &quot;获取CPU信息&quot; &quot;获取系统网络信息&quot; &quot;获取系统内存信息&quot; &quot;获取系统磁盘信息&quot; &quot;获取CPU/内存占用TOP10&quot; &quot;获取系统用户信息&quot; &quot;输出所有信息&quot; &quot;退出&quot; )</span><br><span class="line">printMenu() &#123;</span><br><span class="line">  printf &quot;$&#123;C_BLUE&#125;&quot;</span><br><span class="line">  printf &quot;主菜单：\n&quot;</span><br><span class="line">  for i in &quot;$&#123;!options[@]&#125;&quot;; do</span><br><span class="line">    index=`expr $&#123;i&#125; + 1`</span><br><span class="line">    val=`expr $&#123;index&#125; % 2`</span><br><span class="line">    printf &quot;\t(%02d) %-30s&quot; &quot;$&#123;index&#125;&quot; &quot;$&#123;options[$i]&#125;&quot;</span><br><span class="line">    if [[ $&#123;val&#125; -eq 0 ]]; then</span><br><span class="line">      printf &quot;\n&quot;</span><br><span class="line">    fi</span><br><span class="line">  done</span><br><span class="line">  printf &quot;$&#123;C_BLUE&#125;请输入需要执行的指令：\n&quot;</span><br><span class="line">  printf &quot;$&#123;C_RESET&#125;&quot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">获取系统信息</span></span><br><span class="line">get_systatus_info() &#123;</span><br><span class="line">  sys_os=$(uname -o)</span><br><span class="line">  sys_release=$(cat /etc/redhat-release)</span><br><span class="line">  sys_kernel=$(uname -r)</span><br><span class="line">  sys_hostname=$(hostname)</span><br><span class="line">  sys_selinux=$(getenforce)</span><br><span class="line">  sys_lang=$(echo $LANG)</span><br><span class="line">  sys_lastreboot=$(who -b | awk &#x27;&#123;print $3,$4&#125;&#x27;)</span><br><span class="line">  sys_runtime=$(uptime | awk &#x27;&#123;print  $3,$4&#125;&#x27; | cut -d, -f1)</span><br><span class="line">  sys_time=$(date)</span><br><span class="line">  sys_load=$(uptime | cut -d: -f5)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  cat &lt;&lt; EOF</span><br><span class="line">【系统信息】</span><br><span class="line">系统: $&#123;sys_os&#125;</span><br><span class="line">发行版本:   $&#123;sys_release&#125;</span><br><span class="line">系统内核:   $&#123;sys_kernel&#125;</span><br><span class="line">主机名:    $&#123;sys_hostname&#125;</span><br><span class="line">selinux状态:  $&#123;sys_selinux&#125;</span><br><span class="line">系统语言:   $&#123;sys_lang&#125;</span><br><span class="line">系统当前时间: $&#123;sys_time&#125;</span><br><span class="line">系统最后重启时间:   $&#123;sys_lastreboot&#125;</span><br><span class="line">系统运行时间: $&#123;sys_runtime&#125;</span><br><span class="line">系统负载:   $&#123;sys_load&#125;</span><br><span class="line">EOF</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">获取CPU信息</span></span><br><span class="line">get_cpu_info() &#123;</span><br><span class="line">  Physical_CPUs=$(grep &quot;physical id&quot; /proc/cpuinfo | sort | uniq | wc -l)</span><br><span class="line">  Virt_CPUs=$(grep &quot;processor&quot; /proc/cpuinfo | wc -l)</span><br><span class="line">  CPU_Kernels=$(grep &quot;cores&quot; /proc/cpuinfo | uniq | awk -F &#x27;: &#x27; &#x27;&#123;print $2&#125;&#x27;)</span><br><span class="line">  CPU_Type=$(grep &quot;model name&quot; /proc/cpuinfo | awk -F &#x27;: &#x27; &#x27;&#123;print $2&#125;&#x27; | sort | uniq)</span><br><span class="line">  CPU_Arch=$(uname -m)</span><br><span class="line">  cat &lt;&lt; EOF</span><br><span class="line">【CPU信息】</span><br><span class="line">物理CPU个数:$Physical_CPUs</span><br><span class="line">逻辑CPU个数:$Virt_CPUs</span><br><span class="line">每CPU核心数:$CPU_Kernels</span><br><span class="line">CPU型号:$CPU_Type</span><br><span class="line">CPU架构:$CPU_Arch</span><br><span class="line">EOF</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">获取服务信息</span></span><br><span class="line">get_service_info() &#123;</span><br><span class="line">  port_listen=$(netstat -lntup | grep -v &quot;Active Internet&quot;)</span><br><span class="line">  kernel_config=$(sysctl -p 2&gt; /dev/null)</span><br><span class="line">  if [[ $&#123;sysversion&#125; -gt 6 ]]; then</span><br><span class="line">    service_config=$(systemctl list-unit-files --type=service --state=enabled | grep &quot;enabled&quot;)</span><br><span class="line">    run_service=$(systemctl list-units --type=service --state=running | grep &quot;.service&quot;)</span><br><span class="line">  else</span><br><span class="line">    service_config=$(/sbin/chkconfig | grep -E &quot;:on|:启用&quot; | column -t)</span><br><span class="line">    run_service=$(/sbin/service --status-all | grep -E &quot;running&quot;)</span><br><span class="line">  fi</span><br><span class="line">  cat &lt;&lt; EOF</span><br><span class="line">【服务信息】</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">&#123;service_config&#125;</span></span><br><span class="line"><span class="meta prompt_">  $</span><span class="language-bash">&#123;line&#125;</span></span><br><span class="line">运行的服务:</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">&#123;run_service&#125;</span></span><br><span class="line"><span class="meta prompt_">  $</span><span class="language-bash">&#123;line&#125;</span></span><br><span class="line">监听端口:</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">&#123;port_listen&#125;</span></span><br><span class="line"><span class="meta prompt_">  $</span><span class="language-bash">&#123;line&#125;</span></span><br><span class="line">内核参考配置:</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">&#123;kernel_config&#125;</span></span><br><span class="line">EOF</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">获取系统内存信息</span></span><br><span class="line">get_mem_info() &#123;</span><br><span class="line">  check_mem=$(free -m)</span><br><span class="line">  MemTotal=$(grep MemTotal /proc/meminfo | awk &#x27;&#123;print $2&#125;&#x27;) #KB</span><br><span class="line">  MemFree=$(grep MemFree /proc/meminfo | awk &#x27;&#123;print $2&#125;&#x27;) #KB</span><br><span class="line">  let MemUsed=MemTotal-MemFree</span><br><span class="line">  MemPercent=$(awk &quot;BEGIN &#123;if($MemTotal==0)&#123;printf 100&#125;else&#123;printf \&quot;%.2f\&quot;,$MemUsed*100/$MemTotal&#125;&#125;&quot;)</span><br><span class="line">  report_MemTotal=&quot;$((MemTotal/1024))&quot; &quot;MB&quot; #内存总容量(MB)</span><br><span class="line">  report_MemFree=&quot;$((MemFree/1024))&quot; &quot;MB&quot; #内存剩余(MB)</span><br><span class="line">  report_MemUsedPercent=$(free | sed -n &#x27;2p&#x27; | gawk &#x27;x = int(( $3 / $2 ) * 100) &#123;print x&#125;&#x27; | sed &#x27;s/$/%/&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  cat &lt;&lt; EOF</span><br><span class="line">【内存信息】</span><br><span class="line">内存总容量(MB): $&#123;report_MemTotal&#125;</span><br><span class="line">内存剩余量(MB):$&#123;report_MemFree&#125;</span><br><span class="line">内存使用率: $&#123;report_MemUsedPercent&#125;</span><br><span class="line">EOF</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">获取系统网络信息</span></span><br><span class="line">get_net_info() &#123;</span><br><span class="line">  pri_ipadd=$(ip addr | awk &#x27;/^[0-9]+: / &#123;&#125;; /inet.*global/ &#123;print gensub(/(.*)\/(.*)/, &quot;\\1&quot;, &quot;g&quot;, $2)&#125;&#x27;)</span><br><span class="line">  pub_ipadd=$(curl ifconfig.me -s)</span><br><span class="line">  gateway=$(ip route | grep default | awk &#x27;&#123;print $3&#125;&#x27;)</span><br><span class="line">  mac_info=$(ip link | egrep -v &quot;lo&quot; | grep link | awk &#x27;&#123;print $2&#125;&#x27;)</span><br><span class="line">  dns_config=$(egrep -v &quot;^$|^#&quot; /etc/resolv.conf)</span><br><span class="line">  route_info=$(route -n)</span><br><span class="line">  cat &lt;&lt; EOF</span><br><span class="line">【网络信息】</span><br><span class="line">系统公网地址:$&#123;pub_ipadd&#125;</span><br><span class="line">系统私网地址:$&#123;pri_ipadd&#125;</span><br><span class="line">网关地址:$&#123;gateway&#125;</span><br><span class="line">MAC地址:$&#123;mac_info&#125;</span><br><span class="line">路由信息:</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">&#123;route_info&#125;</span></span><br><span class="line">DNS 信息:</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">&#123;dns_config&#125;</span></span><br><span class="line">EOF</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">获取系统磁盘信息</span></span><br><span class="line">get_disk_info() &#123;</span><br><span class="line">  disk_info=$(fdisk -l | grep &quot;Disk /dev&quot; | cut -d, -f1)</span><br><span class="line">  disk_use=$(df -hTP | awk &#x27;$2!=&quot;tmpfs&quot;&#123;print&#125;&#x27;)</span><br><span class="line">  disk_percent=$(free | sed -n &#x27;2p&#x27; | gawk &#x27;x = int(( $3 / $2 ) * 100) &#123;print x&#125;&#x27; | sed &#x27;s/$/%/&#x27;)</span><br><span class="line">  disk_inode=$(df -hiP | awk &#x27;$1!=&quot;tmpfs&quot;&#123;print&#125;&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  cat &lt;&lt; EOF</span><br><span class="line">【磁盘信息】</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">&#123;disk_info&#125;</span></span><br><span class="line">磁盘使用: $&#123;disk_use&#125;</span><br><span class="line">磁盘使用百分比: $&#123;disk_percent&#125;</span><br><span class="line">inode信息: $&#123;disk_inode&#125;</span><br><span class="line">EOF</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">获取系统用户信息</span></span><br><span class="line">get_sys_user() &#123;</span><br><span class="line">  login_user=$(awk -F: &#x27;&#123;if ($NF==&quot;/bin/bash&quot;) print $0&#125;&#x27; /etc/passwd)</span><br><span class="line">  ssh_config=$(egrep -v &quot;^#|^$&quot; /etc/ssh/sshd_config)</span><br><span class="line">  sudo_config=$(egrep -v &quot;^#|^$&quot; /etc/sudoers | grep -v &quot;^Defaults&quot;)</span><br><span class="line">  host_config=$(egrep -v &quot;^#|^$&quot; /etc/hosts)</span><br><span class="line">  crond_config=$(for cronuser in /var/spool/cron/*; do</span><br><span class="line">    ls $&#123;cronuser&#125; 2&gt; /dev/null | cut -d/ -f5; egrep -v &quot;^$|^#&quot; $&#123;cronuser&#125; 2&gt; /dev/null;</span><br><span class="line">    echo &quot;&quot;;</span><br><span class="line">  done)</span><br><span class="line">  cat &lt;&lt; EOF</span><br><span class="line">【用户信息】</span><br><span class="line">系统登录用户:</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">&#123;login_user&#125;</span></span><br><span class="line"><span class="meta prompt_">  $</span><span class="language-bash">&#123;line&#125;</span></span><br><span class="line">ssh 配置信息:</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">&#123;ssh_config&#125;</span></span><br><span class="line"><span class="meta prompt_">  $</span><span class="language-bash">&#123;line&#125;</span></span><br><span class="line">sudo 配置用户:</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">&#123;sudo_config&#125;</span></span><br><span class="line"><span class="meta prompt_">  $</span><span class="language-bash">&#123;line&#125;</span></span><br><span class="line">定时任务配置:</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">&#123;crond_config&#125;</span></span><br><span class="line"><span class="meta prompt_">  $</span><span class="language-bash">&#123;line&#125;</span></span><br><span class="line">hosts 信息:</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">&#123;host_config&#125;</span></span><br><span class="line">EOF</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">获取CPU/内存占用TOP10</span></span><br><span class="line">get_process_top_info() &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  top_title=$(top -b n1 | head -7 | tail -1)</span><br><span class="line">  cpu_top10=$(top -b n1 | head -17 | tail -11)</span><br><span class="line">  mem_top10=$(top -b n1 | head -17 | tail -10 | sort -k10 -r)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  cat &lt;&lt; EOF</span><br><span class="line">【TOP10】</span><br><span class="line">CPU占用TOP10:</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">&#123;cpu_top10&#125;</span></span><br><span class="line">内存占用TOP10:</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">&#123;top_title&#125;</span></span><br><span class="line"><span class="meta prompt_">  $</span><span class="language-bash">&#123;mem_top10&#125;</span></span><br><span class="line">EOF</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">show_dead_process() &#123;</span><br><span class="line">  printf &quot;僵尸进程：\n&quot;</span><br><span class="line">  ps -al | gawk &#x27;&#123;print $2,$4&#125;&#x27; | grep Z</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">get_all_info() &#123;</span><br><span class="line">  get_systatus_info</span><br><span class="line">  echo $&#123;double_line&#125;</span><br><span class="line">  get_service_info</span><br><span class="line">  echo $&#123;double_line&#125;</span><br><span class="line">  get_cpu_info</span><br><span class="line">  echo $&#123;double_line&#125;</span><br><span class="line">  get_net_info</span><br><span class="line">  echo $&#123;double_line&#125;</span><br><span class="line">  get_mem_info</span><br><span class="line">  echo $&#123;double_line&#125;</span><br><span class="line">  get_disk_info</span><br><span class="line">  echo $&#123;double_line&#125;</span><br><span class="line">  get_process_top_info</span><br><span class="line">  echo $&#123;double_line&#125;</span><br><span class="line">  get_sys_user</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">main() &#123;</span><br><span class="line">  while [[ 1 ]]</span><br><span class="line">  do</span><br><span class="line">    printMenu</span><br><span class="line">    read option</span><br><span class="line">    local index=$[ $&#123;option&#125; - 1 ]</span><br><span class="line">    case $&#123;options[$&#123;index&#125;]&#125; in</span><br><span class="line">      &quot;获取系统信息&quot;)</span><br><span class="line">        get_systatus_info ;;</span><br><span class="line">      &quot;获取服务信息&quot;)</span><br><span class="line">        get_service_info ;;</span><br><span class="line">      &quot;获取CPU信息&quot;)</span><br><span class="line">        get_cpu_info ;;</span><br><span class="line">      &quot;获取系统网络信息&quot;)</span><br><span class="line">        get_net_info ;;</span><br><span class="line">      &quot;获取系统内存信息&quot;)</span><br><span class="line">        get_mem_info ;;</span><br><span class="line">      &quot;获取系统磁盘信息&quot;)</span><br><span class="line">        get_disk_info ;;</span><br><span class="line">      &quot;获取CPU/内存占用TOP10&quot;)</span><br><span class="line">        get_process_top_info ;;</span><br><span class="line">      &quot;获取系统用户信息&quot;)</span><br><span class="line">        get_sys_user ;;</span><br><span class="line">      &quot;输出所有信息&quot;)</span><br><span class="line">        get_all_info &gt; sys.log</span><br><span class="line">        printf &quot;$&#123;C_GREEN&#125;信息已经输出到 sys.log 中。$&#123;C_RESET&#125;\n\n&quot;</span><br><span class="line">      ;;</span><br><span class="line">      &quot;退出&quot;)</span><br><span class="line">        exit ;;</span><br><span class="line">      *)</span><br><span class="line">        clear</span><br><span class="line">        echo &quot;抱歉，不支持此选项&quot; ;;</span><br><span class="line">    esac</span><br><span class="line">  done</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">####################################### MAIN ########################################</span></span></span><br><span class="line">printHeadInfo</span><br><span class="line">main</span><br><span class="line">printFootInfo</span><br><span class="line">printf &quot;$&#123;C_RESET&#125;&quot;</span><br></pre></td></tr></table></figure>

<h3 id="sed进阶"><a href="#sed进阶" class="headerlink" title="sed进阶"></a><strong>sed进阶</strong></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">多个空格只保留一个</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">sed <span class="string">&#x27;/./,/^$/!d&#x27;</span> <span class="built_in">test</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">删除开头的空白行</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">sed <span class="string">&#x27;/./,$!d&#x27;</span> <span class="built_in">test</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">删除结尾的空白行</span></span><br><span class="line">sed &#x27;&#123;</span><br><span class="line">:start</span><br><span class="line">/^\n*$/&#123;$d; N; b start&#125;</span><br><span class="line">&#125;&#x27; test</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">删除html标签</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">有问题</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">s/&lt;.*&gt;//g</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">sed <span class="string">&#x27;s/&lt;[^&gt;]*&gt;//g&#x27;</span> test1</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">sed <span class="string">&#x27;s/&lt;[^&gt;]*&gt;//g;/^$/d&#x27;</span> test1</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">and符号，代表替换命令中的匹配模式，不管预定义模式是什么文本，都可以用and符号替换，and符号会提取匹配替换命令中指定替换模式中的所有字符串</span></span><br><span class="line">echo &quot;The cat sleeps in his hat&quot; | sed &#x27;s/.at/&quot;&amp;&quot;/g&#x27;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">替换单独的单词</span></span><br><span class="line">echo &quot;The System Administrator manual&quot; | sed &#x27;s/\(System\) Administrator/\1 user/&#x27;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">在长数字中插入逗号</span></span><br><span class="line">echo &quot;1234567&quot; | sed &#x27;&#123;:start; s/\(.*[0-9]\)\([0-9]\&#123;3\&#125;\)/\1,\2/; t start&#125;&#x27;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">给文件中的行编号</span></span><br><span class="line">sed &#x27;=&#x27; test | sed &#x27;N; s/\n/ /&#x27;</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://example.com">TYsec</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://example.com/posts/fff87d43.html/">http://example.com/posts/fff87d43.html/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">TYsec</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Linux%E8%BF%90%E7%BB%B4/">Linux运维</a></div><div class="post_share"><div class="social-share" data-image="https://s2.loli.net/2023/01/15/5KLlANftgSvFBz2.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/b0baaa51.html/"><img class="prev-cover" src="https://s2.loli.net/2023/02/24/qyE2b1PNZzGrnSM.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">基于Ubuntu16.04同时部署多道pwn题目</div></div></a></div><div class="next-post pull-right"><a href="/posts/d5b32943.html/"><img class="next-cover" src="https://s2.loli.net/2023/02/07/gwZAW5vpQjx4Piz.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">信息收集工具recon-ng超详细使用教程</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://q1.qlogo.cn/g?b=qq&amp;nk=2142516016&amp;s=640" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">TYsec</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">11</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">8</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">11</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Abyssun"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Abyssun" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:tysec_web@163.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">TYsec:来自商丘师范学院的网络安全团队</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="toc-number">1.</span> <span class="toc-text">常用命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mysql%E5%A4%87%E4%BB%BD"><span class="toc-number">2.</span> <span class="toc-text">mysql备份</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95%E5%A4%87%E4%BB%BD"><span class="toc-number">3.</span> <span class="toc-text">目录备份</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PING%E6%9F%A5%E8%AF%A2"><span class="toc-number">4.</span> <span class="toc-text">PING查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A3%81%E7%9B%98IO%E6%A3%80%E6%9F%A5"><span class="toc-number">5.</span> <span class="toc-text">磁盘IO检查</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%A7%E8%83%BD%E7%9B%B8%E5%85%B3"><span class="toc-number">6.</span> <span class="toc-text">性能相关</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E7%9B%B8%E5%85%B3"><span class="toc-number">7.</span> <span class="toc-text">进程相关</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#javadump-sh"><span class="toc-number">8.</span> <span class="toc-text">javadump.sh</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7%E5%AE%89%E8%A3%85"><span class="toc-number">9.</span> <span class="toc-text">常用工具安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8lib%E5%BA%93%E5%AE%89%E8%A3%85"><span class="toc-number">10.</span> <span class="toc-text">常用lib库安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B3%BB%E7%BB%9F%E6%A3%80%E6%9F%A5%E8%84%9A%E6%9C%AC"><span class="toc-number">11.</span> <span class="toc-text">系统检查脚本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sed%E8%BF%9B%E9%98%B6"><span class="toc-number">12.</span> <span class="toc-text">sed进阶</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/f19d15b1.html/" title="sqlmap的简单使用"><img src="https://s2.loli.net/2023/06/15/gMqywsQlIK3OCmu.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="sqlmap的简单使用"/></a><div class="content"><a class="title" href="/posts/f19d15b1.html/" title="sqlmap的简单使用">sqlmap的简单使用</a><time datetime="2023-06-16T01:16:16.000Z" title="发表于 2023-06-16 09:16:16">2023-06-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/97d07a5c.html/" title="缓冲区与setvbuf函数"><img src="https://cdn.staticaly.com/gh/Abyssun/picx-images-hosting@master/20230409/v2-42a751c6dde2a0b47939369b6cf6264c_1440w.2ku6hllf9960.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="缓冲区与setvbuf函数"/></a><div class="content"><a class="title" href="/posts/97d07a5c.html/" title="缓冲区与setvbuf函数">缓冲区与setvbuf函数</a><time datetime="2023-04-09T02:48:20.000Z" title="发表于 2023-04-09 10:48:20">2023-04-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/9e12257e.html/" title="ctfshow-愚人杯赛题复现"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ctfshow-愚人杯赛题复现"/></a><div class="content"><a class="title" href="/posts/9e12257e.html/" title="ctfshow-愚人杯赛题复现">ctfshow-愚人杯赛题复现</a><time datetime="2023-04-07T08:09:23.000Z" title="发表于 2023-04-07 16:09:23">2023-04-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/d5e8fca.html/" title="pwn入门刷题记录（一）"><img src="https://cdn.staticaly.com/gh/Abyssun/picx-images-hosting@master/20230402/1.6xawu1bglk80.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="pwn入门刷题记录（一）"/></a><div class="content"><a class="title" href="/posts/d5e8fca.html/" title="pwn入门刷题记录（一）">pwn入门刷题记录（一）</a><time datetime="2023-04-02T15:09:40.000Z" title="发表于 2023-04-02 23:09:40">2023-04-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/9b311c28.html/" title="【SQL注入】SQL注入这一篇就够了"><img src="https://cdn.staticaly.com/gh/Abyssun/picx-images-hosting@master/20200917143714.3oip218ppug0.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="【SQL注入】SQL注入这一篇就够了"/></a><div class="content"><a class="title" href="/posts/9b311c28.html/" title="【SQL注入】SQL注入这一篇就够了">【SQL注入】SQL注入这一篇就够了</a><time datetime="2023-02-25T00:37:53.000Z" title="发表于 2023-02-25 08:37:53">2023-02-25</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://s2.loli.net/2023/01/15/5KLlANftgSvFBz2.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By TYsec</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi, welcome to my <a target="_blank" rel="noopener" href="https://tysec.easyctf.cn/">blog</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
    }

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="true" data-click="true"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>